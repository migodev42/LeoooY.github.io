<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.62">
<title data-react-helmet="true">[è¯‘] Blinkå†…æ ¸æ˜¯å¦‚ä½•å·¥ä½œçš„? | DocsShare</title><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="[è¯‘] Blinkå†…æ ¸æ˜¯å¦‚ä½•å·¥ä½œçš„? | DocsShare"><meta data-react-helmet="true" name="description" content="åŸæ–‡é“¾æ¥"><meta data-react-helmet="true" property="og:description" content="åŸæ–‡é“¾æ¥"><meta data-react-helmet="true" property="og:url" content="https://leoooy.github.io//docs/FE/Browser/Blinkå†…æ ¸æ˜¯å¦‚ä½•å·¥ä½œçš„/doc-Blinkå†…æ ¸æ˜¯å¦‚ä½•å·¥ä½œçš„"><link data-react-helmet="true" rel="shortcut icon" href="/img/leo.png"><link data-react-helmet="true" rel="canonical" href="https://leoooy.github.io//docs/FE/Browser/Blinkå†…æ ¸æ˜¯å¦‚ä½•å·¥ä½œçš„/doc-Blinkå†…æ ¸æ˜¯å¦‚ä½•å·¥ä½œçš„"><link rel="stylesheet" href="/styles.fcc05d64.css">
<link rel="preload" href="/styles.da09b0aa.js" as="script">
<link rel="preload" href="/runtime~main.872dded8.js" as="script">
<link rel="preload" href="/main.2f1d5848.js" as="script">
<link rel="preload" href="/1.f45b894e.js" as="script">
<link rel="preload" href="/2.a477ba05.js" as="script">
<link rel="preload" href="/3.b78202e8.js" as="script">
<link rel="preload" href="/1be78505.89b8407a.js" as="script">
<link rel="preload" href="/171.d3ef19ea.js" as="script">
<link rel="preload" href="/935f2afb.43a6fc9a.js" as="script">
<link rel="preload" href="/17896441.30e2172e.js" as="script">
<link rel="preload" href="/38ab2617.b77077ba.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/leo.png" alt="My Site Logo"><strong class="navbar__title">My DocsShare</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">Notes</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/LeoooY" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><a href="https://juejin.im/user/5bebc171e51d4511a8090edb/posts" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">æ˜é‡‘</a><a href="https://twitter.com/LeoY233" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Twitter</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ğŸŒ</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/leo.png" alt="My Site Logo"><strong class="navbar__title">My DocsShare</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs">Notes</a></li><li class="menu__list-item"><a class="menu__link" href="/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/LeoooY" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a href="https://juejin.im/user/5bebc171e51d4511a8090edb/posts" target="_blank" rel="noopener noreferrer" class="menu__link">æ˜é‡‘</a></li><li class="menu__list-item"><a href="https://twitter.com/LeoY233" target="_blank" rel="noopener noreferrer" class="menu__link">Twitter</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">C++</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/C++/doc-C++-C++PrimerNotes">C++PrimerNotes</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Network</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/">TCP3æ¬¡æ¡æ‰‹å’Œ4æ¬¡æŒ¥æ‰‹</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">FE</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Browser</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/FE/Browser/Blinkå†…æ ¸æ˜¯å¦‚ä½•å·¥ä½œçš„/doc-Blinkå†…æ ¸æ˜¯å¦‚ä½•å·¥ä½œçš„">[è¯‘] Blinkå†…æ ¸æ˜¯å¦‚ä½•å·¥ä½œçš„?</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">React</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/FE/React/ReactHooksä½¿ç”¨å¿ƒå¾—/doc-ReactHooksä½¿ç”¨å¿ƒå¾—">ReactHooksä½¿ç”¨å¿ƒå¾—</a></li></ul></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><div><span class="badge badge--secondary">Version: Next</span></div><header><h1 class="docTitle_1Lrw">[è¯‘] Blinkå†…æ ¸æ˜¯å¦‚ä½•å·¥ä½œçš„?</h1></header><div class="markdown"><p><a href="https://docs.google.com/document/d/1aitSOucL0VHZa9Z2vbRJSyAIsAz24kX8LFByQ5xQnUg/edit?usp=sharing" target="_blank" rel="noopener noreferrer">åŸæ–‡é“¾æ¥</a></p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="blink-æ˜¯å¦‚ä½•å·¥ä½œçš„"></a>Blink æ˜¯å¦‚ä½•å·¥ä½œçš„<a aria-hidden="true" tabindex="-1" class="hash-link" href="#blink-æ˜¯å¦‚ä½•å·¥ä½œçš„" title="Direct link to heading">#</a></h1><p>Author: haraken@
Last update: 2018 Aug 14
Status: PUBLIC
è¯‘: <a href="https://github.com/LeoooY" target="_blank" rel="noopener noreferrer">LeoY</a></p><p>å¯¹äºåˆšæ¥è§¦ <code>Blink</code> çš„å¼€å‘è€…æ¥è¯´ï¼Œ <code>Blink</code> ç›¸å…³çš„å·¥ä½œå¹¶ä¸ç®€å•ã€‚å› ä¸ºå®ç°ä¸€ä¸ªé«˜æ•ˆå¿«é€Ÿçš„æ¸²æŸ“å¼•æ“ï¼Œéœ€è¦äº†è§£å¤§é‡ä¸ <code>Blink</code> ç›¸å…³çš„æ¦‚å¿µå’Œä»£ç çº¦å®šã€‚è¿™å¯¹äºç»éªŒä¸°å¯Œçš„ <code>Blink</code> å¼€å‘è€…æ¥è¯´ä¹Ÿå¹¶ä¸ç®€å•ï¼Œå› ä¸º <code>Blink</code> é¡¹ç›®å¾ˆåºå¤§ï¼Œå¹¶ä¸”å¯¹äºæ€§èƒ½ã€å†…å­˜å’Œå®‰å…¨æ€§å¾ˆæ•æ„Ÿã€‚</p><p>æœ¬æ–‡çš„ç›®æ ‡æ˜¯æä¾›ä¸€ä¸ªå…³äº <code>Blink</code> å·¥ä½œåŸç†çš„æ¦‚è§ˆï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åŠ©å¼€å‘è€…å¿«é€Ÿç†Ÿæ‚‰ <code>Blink</code> çš„æ¶æ„ã€‚</p><ul><li>æœ¬æ–‡ä¸æ˜¯ä¸€ä¸ªå…³äº <code>Blink</code> æ¶æ„ç»†èŠ‚å’Œä»£ç é£æ ¼çš„è¯¦ç»†æ•™ç¨‹ï¼Œè€Œæ˜¯å…³äº <code>Blink</code> åŸºæœ¬åŸç†çš„ç®€å•ä»‹ç»ã€‚è¿™éƒ¨åˆ†åŸç†åœ¨çŸ­æœŸå†…ä¸ä¼šæœ‰å¤§çš„æ”¹å˜ï¼Œå¦å¤–æä¾›äº†ä¸€äº›æ·±å…¥äº†è§£è¿™äº›éƒ¨åˆ†çš„ç›¸å…³èµ„æºã€‚</li><li>æœ¬æ–‡ä¸ä¼šä»‹ç»å…·ä½“çš„åŠŸèƒ½ï¼ˆæ¯”å¦‚ <code>ServiceWorkers</code> ï¼Œ <code>editing</code> ç­‰ï¼‰ï¼Œè€Œæ˜¯ä»‹ç»äº†ä»£ç ä¸­å¹¿æ³›ä½¿ç”¨çš„ä¸€äº›åŸºæœ¬çš„åŠŸèƒ½ï¼ˆæ¯”å¦‚å†…å­˜ç®¡ç†ï¼Œ <code>V8 APIs</code> ç­‰ï¼‰</li></ul><p>è®¿é—® <a href="https://www.chromium.org/blink" target="_blank" rel="noopener noreferrer">Chromium wiki page</a> æ¥è·å–æ›´å¤šçš„å…³äº <code>Blink</code> å¼€å‘çš„ä¿¡æ¯</p><ul><li><a href="#blink-%E6%98%AF%E5%A6%82%E4%BD%95%E5%B7%A5%E4%BD%9C%E7%9A%84">Blink æ˜¯å¦‚ä½•å·¥ä½œçš„</a><ul><li><a href="#blink-%E5%81%9A%E4%BA%86%E4%BB%80%E4%B9%88"><code>Blink</code> åšäº†ä»€ä¹ˆ</a></li><li><a href="#%E8%BF%9B%E7%A8%8B%E7%BA%BF%E7%A8%8B-%E6%9E%B6%E6%9E%84">è¿›ç¨‹/çº¿ç¨‹ æ¶æ„</a><ul><li><a href="#%E8%BF%9B%E7%A8%8B">è¿›ç¨‹</a></li><li><a href="#%E7%BA%BF%E7%A8%8B">çº¿ç¨‹</a></li><li><a href="#blink-%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E7%BB%88%E6%AD%A2"><code>Blink</code> çš„åˆå§‹åŒ–å’Œç»ˆæ­¢</a></li></ul></li><li><a href="#%E7%9B%AE%E5%BD%95%E6%9E%B6%E6%9E%84">ç›®å½•æ¶æ„</a><ul><li><a href="#content-public-apis-%E5%92%8C-blink-public-apis"><code>Content public APIs</code> å’Œ <code>Blink public APIs</code></a></li><li><a href="#%E7%9B%AE%E5%BD%95%E6%9E%B6%E6%9E%84%E5%92%8C%E4%BE%9D%E8%B5%96">ç›®å½•æ¶æ„å’Œä¾èµ–</a></li><li><a href="#wtf">WTF</a></li></ul></li><li><a href="#%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86">å†…å­˜ç®¡ç†</a></li><li><a href="#%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6">ä»»åŠ¡è°ƒåº¦</a></li><li><a href="#page--frame--document--domwindow-etc"><code>Page</code> , <code>Frame</code> , <code>Document</code> , <code>DOMWindow</code> etc</a><ul><li><a href="#%E6%A6%82%E5%BF%B5">æ¦‚å¿µ</a></li><li><a href="#out-of-process-iframes-oopif-%E8%BF%9B%E7%A8%8B%E5%A4%96%E7%9A%84iframe">Out-of-Process iframes (OOPIF è¿›ç¨‹å¤–çš„iframe)</a></li><li><a href="#detached-frame--document--%E5%88%86%E7%A6%BB%E7%9A%84frame--document">Detached Frame / Document  åˆ†ç¦»çš„Frame / Document</a></li></ul></li><li><a href="#web-idl-bindings-web-idl%E7%BB%91%E5%AE%9A">Web IDL bindings: Web IDLç»‘å®š</a></li><li><a href="#v8-%E5%92%8C-blink">V8 å’Œ Blink</a><ul><li><a href="#isolate-context-world">Isolate, Context, World</a></li><li><a href="#v8-apis">V8 APIs</a></li><li><a href="#v8-wrappers">V8 wrappers</a></li></ul></li><li><a href="#%E6%B8%B2%E6%9F%93%E7%AE%A1%E9%81%93-rendering-pipeline">æ¸²æŸ“ç®¡é“ Rendering pipeline</a></li><li><a href="#questions">Questions?</a></li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="blink-åšäº†ä»€ä¹ˆ"></a><code>Blink</code> åšäº†ä»€ä¹ˆ<a aria-hidden="true" tabindex="-1" class="hash-link" href="#blink-åšäº†ä»€ä¹ˆ" title="Direct link to heading">#</a></h2><p><a href="https://www.chromium.org/blink" target="_blank" rel="noopener noreferrer"> <code>Blink</code> </a> æ˜¯ä¸€ä¸ªWebå¹³å°çš„æ¸²æŸ“å¼•æ“ã€‚ç²—ç•¥åœ°è¯´ï¼Œåœ¨ä¸€ä¸ªæµè§ˆå™¨tabé¡µä¸­ä¸å†…å®¹æ¸²æŸ“ç›¸å…³çš„æ‰€æœ‰äº‹æƒ…éƒ½æ˜¯ç”± <code>Blink</code> å®ç°çš„ã€‚</p><ul><li><p>å®ç°Webå¹³å°çš„è§„æ ¼ï¼ˆæ¯”å¦‚, <a href="https://html.spec.whatwg.org/multipage/?" target="_blank" rel="noopener noreferrer">HTMLæ ‡å‡†è§„æ ¼</a>ï¼‰ï¼ŒåŒ…æ‹¬ <code>DOM</code> , <code>CSS</code> å’Œ <code>Web IDL</code> (<a href="https://en.wikipedia.org/wiki/Web_IDL" target="_blank" rel="noopener noreferrer">Webæµè§ˆå™¨ç¼–ç¨‹æ¥å£æè¿°</a>)</p></li><li><p>åµŒå…¥ <code>V8</code> å’Œè¿è¡Œ <code>Javascript</code></p></li><li><p>ä»åº•å±‚çš„ç½‘ç»œå †æ ˆè¯·æ±‚èµ„æº</p></li><li><p>æ„å»º <code>DOM tree</code></p></li><li><p>è®¡ç®—æ ·å¼å’Œå¸ƒå±€</p></li><li><p>åµŒå…¥ <a href="https://chromium.googlesource.com/chromium/src/+/HEAD/cc/README.md" target="_blank" rel="noopener noreferrer"> <code>Chrome Compositor</code> </a> å’Œå›¾å½¢æ¸²æŸ“ç»˜åˆ¶</p><ul><li><p>what is Chrome Compositor?</p><blockquote><p>cc is responsible for taking painted inputs from its embedder, figuring out where and if they appear on screen, rasterizing and decoding and animating images from the painted input into gpu textures, and finally forwarding those textures on to the display compositor in the form of a compositor frame. cc also handles input forwarded from the browser process to handle pinch and scroll gestures responsively without involving Blink.</p></blockquote></li></ul></li></ul><p>åœ¨å¾ˆå¤šåœ°æ–¹éƒ½èƒ½è§åˆ° <code>Blink</code> çš„èº«å½±ï¼Œæ¯”å¦‚ <code>Chromium</code> ï¼Œ <code>Android WebView</code> ä»¥åŠé€šè¿‡ <a href="https://chromium.googlesource.com/chromium/src/+/HEAD/content/public/README.md" target="_blank" rel="noopener noreferrer">content public APIs</a> å†…åµŒ <code>Blink</code> çš„ <code>Opera</code> æµè§ˆå™¨ã€‚</p><p><img src="/assets/images/image3-2d0abb3b2f3d0e2c43d197e9691effd6.png"></p><p>ä»ä»£ç åº“çš„è§’åº¦æ¥çœ‹ï¼Œ <code>Blink</code> å¯¹åº” <code>//third_party/blink/</code> ã€‚
ä»é¡¹ç›®æœ¬èº«æ¥çœ‹ï¼Œ <code>Blink</code> å®ç°äº†Webå¹³å°çš„åŠŸèƒ½ï¼Œè¿™äº›ä»£ç åœ¨ä¸»è¦åœ¨ <code>//third_party/blink/</code> ï¼Œ <code>//content/renderer/</code> ï¼Œ <code>//content/browser/</code> ç›®å½•ä¸­ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="è¿›ç¨‹çº¿ç¨‹-æ¶æ„"></a>è¿›ç¨‹/çº¿ç¨‹ æ¶æ„<a aria-hidden="true" tabindex="-1" class="hash-link" href="#è¿›ç¨‹çº¿ç¨‹-æ¶æ„" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="è¿›ç¨‹"></a>è¿›ç¨‹<a aria-hidden="true" tabindex="-1" class="hash-link" href="#è¿›ç¨‹" title="Direct link to heading">#</a></h3><p><code>Chromium</code> æ˜¯ä¸€ä¸ª <a href="https://www.chromium.org/developers/design-documents/multi-process-architecture" target="_blank" rel="noopener noreferrer">å¤šè¿›ç¨‹æ¶æ„ multi-process architecture</a> çš„æµè§ˆå™¨å¼•æ“ ã€‚ <code>Chromium</code> è¿è¡Œæ—¶ä¼šåˆ›å»ºä¸€ä¸ªæµè§ˆå™¨è¿›ç¨‹å’ŒNä¸ªåœ¨æ²™ç›’ä¸­è¿è¡Œçš„æ¸²æŸ“è¿›ç¨‹ã€‚ <code>Blink</code> åˆ™æ˜¯åœ¨æ¸²æŸ“è¿›ç¨‹ä¸­è¿è¡Œçš„ã€‚</p><p>åˆ›å»ºå¤šå°‘æ¸²æŸ“è¿›ç¨‹ï¼Ÿä¸€èˆ¬æ¥è¯´ï¼Œä¸€ä¸ª <code>site</code> ä¼šç‹¬å ä¸€ä¸ªæ¸²æŸ“è¿›ç¨‹ï¼Œè€Œå½“ç”¨æˆ·å¼€å¤ªå¤štabsé¡µé¢å†…å­˜ä¸è¶³æ—¶ï¼Œå¤šä¸ª <code>site</code> å¯èƒ½ä¼šå…±äº«ä¸€ä¸ªæ¸²æŸ“è¿›ç¨‹ã€‚</p><blockquote><p>å‡ºäºå®‰å…¨æ€§çš„è€ƒè™‘ï¼Œè·¨ç«™æ–‡æ¡£ï¼ˆcross-site documentsï¼‰çš„å†…å­˜åœ°å€ä¼šè¢«éš”ç¦»å¼€æ¥ï¼ˆè¿™è¢«ç§°ä¸º<a href="https://www.chromium.org/Home/chromium-security/site-isolation" target="_blank" rel="noopener noreferrer">Site Isolation</a>ï¼‰ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œæ¯ä¸ªæ¸²æŸ“è¿›ç¨‹æ˜¯æ¯ä¸ªç½‘ç«™ä¸“ç”¨çš„ï¼Œç„¶è€Œå½“ç”¨æˆ·æ‰“å¼€å¤ªå¤šæ ‡ç­¾é¡µæˆ–è€…æœºå™¨å†…å­˜ä¸å¤Ÿæ—¶ï¼Œè¿™ç§é™åˆ¶å°±å¾ˆéº»çƒ¦ã€‚æ‰€ä»¥å®é™…ä¸Šï¼Œå¤šä¸ªé¡µé¢æˆ–è€…ä¸åŒç½‘ç«™çš„å¤šä¸ª <code>iframe</code> å¯èƒ½ä¼šå…±äº«åŒä¸€ä¸ªæ¸²æŸ“ã€‚è¿™æ„å‘³ç€ä¸€ä¸ªtabé¡µä¸­çš„å¤šä¸ª <code>iframe</code> å¯èƒ½æ˜¯ä¸åŒçš„æ¸²æŸ“è¿›ç¨‹æ¸²æŸ“çš„ï¼Œä¸åŒçš„tabé¡µä¸­çš„ <code>iframe</code> ä¹Ÿæœ‰æœ‰å¯èƒ½æ˜¯åŒä¸€ä¸ªæ¸²æŸ“è¿›ç¨‹æ¸²æŸ“çš„ã€‚<strong>æ‰€ä»¥æ¸²æŸ“è¿›ç¨‹ï¼Œiframe å’Œ tab ä¸‰è€…ä¹‹é—´ä¸æ˜¯ï¼ˆ1ï¼š1ï¼‰ä¸€å¯¹ä¸€çš„æ˜ å°„å…³ç³»</strong></p></blockquote><p>ç”±äºæ¸²æŸ“è¿›ç¨‹æ˜¯è¿è¡Œåœ¨æ²™ç›’ä¸­çš„ï¼Œæ‰€ä»¥ <code>Blink</code> éœ€è¦å‘æµè§ˆå™¨è¿›ç¨‹å‘èµ·ç³»ç»Ÿè°ƒç”¨ï¼ˆæ¯”å¦‚æ–‡ä»¶è®¿é—®ï¼ŒéŸ³é¢‘æ’­æ”¾ï¼‰å’Œï¼ˆç”¨æˆ·é…ç½®ï¼‰æ•°æ®çš„è·å–ï¼ˆæ¯”å¦‚ <code>Cookie</code> ï¼Œå¯†ç ï¼‰ã€‚æµè§ˆå™¨è¿›ç¨‹å’Œæ¸²æŸ“è¿›ç¨‹ä¹‹é—´é€šè¿‡ <a href="https://chromium.googlesource.com/chromium/src/+/master/mojo/README.md" target="_blank" rel="noopener noreferrer">Mojo</a> å®ç°é€šä¿¡ã€‚ï¼ˆNote: ä»¥å‰æ˜¯é€šè¿‡ <a href="https://www.chromium.org/developers/design-documents/inter-process-communication" target="_blank" rel="noopener noreferrer">Chromium IPC</a> å®ç°ï¼Œç°åœ¨è¿˜æœ‰éƒ¨åˆ†ä»£ç ä»åœ¨ä½¿ç”¨ï¼Œä½†æ˜¯ä¼šé€æ¸å¼ƒç”¨ï¼‰ <code>Chromium</code> ä¸­çš„ <code>Servicification</code> å°†æµè§ˆå™¨è¿›ç¨‹å°è£…å‡ºäº†ä¸€äº›ç‹¬ç«‹çš„æœåŠ¡ã€‚ <code>Blink</code> å¯ä»¥ç›´æ¥ä½¿ç”¨ <code>Mojo</code> è°ƒç”¨è¿™äº›ç‹¬ç«‹æœåŠ¡æ¥æˆ–è€…ä¸æµè§ˆå™¨è¿›ç¨‹äº¤äº’ã€‚</p><p><img src="/assets/images/image5-0a8bd4de9888158e50b2d2cf4fce559c.png"></p><p>äº†è§£æ›´å¤šï¼š</p><ul><li><a href="https://www.chromium.org/developers/design-documents/multi-process-architecture" target="_blank" rel="noopener noreferrer">å¤šè¿›ç¨‹æ¶æ„ Multi-process Architecture</a></li><li>åœ¨Blinkä¸­ä½¿ç”¨Mojoè¿›è¡Œå¼€å‘ Mojo programming in Blink: platform/mojo/MojoProgrammingInBlink. md</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="çº¿ç¨‹"></a>çº¿ç¨‹<a aria-hidden="true" tabindex="-1" class="hash-link" href="#çº¿ç¨‹" title="Direct link to heading">#</a></h3><p>åœ¨ä¸€ä¸ªæ¸²æŸ“è¿›ç¨‹ä¸­åˆ›å»ºäº†å¤šå°‘çº¿ç¨‹ï¼Ÿ</p><p><code>Blink</code> ä¸­ä¼šæœ‰ä¸€ä¸ªä¸»çº¿ç¨‹ï¼ŒNä¸ªå·¥ä½œçº¿ç¨‹å’Œä¸‰ä¸¤ä¸ªå†…éƒ¨çº¿ç¨‹ã€‚</p><p>å‡ ä¹æ‰€æœ‰é‡è¦çš„äº‹æƒ…éƒ½å‘ç”Ÿåœ¨ä¸»çº¿ç¨‹ä¸­ã€‚ <code>Javascript</code> ï¼ˆä¸åŒ…æ‹¬ <code>service worker</code> ï¼‰ï¼Œ <code>DOM</code> ï¼Œ <code>CSS</code> ï¼Œæ ·å¼å’Œå¸ƒå±€è®¡ç®—éƒ½åœ¨ä¸»çº¿ç¨‹ä¸­è¿è¡Œã€‚
<code>Blink</code> é€šè¿‡è®¸å¤šä¼˜åŒ–æ¥æœ€å¤§åŒ–ä¸»çº¿ç¨‹çš„æ€§èƒ½ï¼Œæ¨¡æ‹Ÿäº†ä¸€ä¸ªè¿‘ä¹å•çº¿ç¨‹çš„æ¶æ„ã€‚
<code>Blink</code> å¯èƒ½ä¼šåˆ›å»ºå¤šä¸ªå·¥ä½œçº¿ç¨‹æ¥è¿è¡Œ <a href="https://html.spec.whatwg.org/multipage/workers.html#workers" target="_blank" rel="noopener noreferrer"> <code>Web Workers</code> </a>ï¼Œ<a href="https://w3c.github.io/ServiceWorker/" target="_blank" rel="noopener noreferrer"> <code>ServiceWorker</code> </a>ä»¥åŠ<a href="https://www.w3.org/TR/worklets-1/" target="_blank" rel="noopener noreferrer"> <code>Worklet</code> </a>ã€‚
<code>Blink</code> å’Œ <code>V8</code> å¯èƒ½ä¼šåˆ›å»ºä¸‰ä¸¤ä¸ªå†…éƒ¨è¿›ç¨‹æ¥å¤„ç† <code>éŸ³é¢‘ webaudio</code> , <code>æ•°æ®åº“ database</code> , <code>å†…å­˜å›æ”¶ GC</code> ç­‰ã€‚</p><p>çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼Œéœ€è¦ä½¿ç”¨ <code>PostTask APIs</code> æ¥ä¼ é€’ã€‚
å‡ºäºæ€§èƒ½çš„è€ƒè™‘ï¼Œé™¤äº†å‡ ä¸ªç‰¹åˆ«çš„åœ°æ–¹ï¼Œå…±äº«å†…å­˜ç¼–ç¨‹æ˜¯ä¸æ¨èçš„ï¼Œæ‰€ä»¥åœ¨ <code>Blink</code> ä¸­æºç ä¸­ä¹Ÿå¾ˆå°‘ä½¿ç”¨äº’æ–¥é”è¿™ç§ä¸œè¥¿ã€‚</p><p><img src="/assets/images/image2-d8a67f1ecbbff6525042f93749396961.png"></p><p>äº†è§£æ›´å¤šï¼š</p><ul><li><code>Blink</code> ä¸­çš„çº¿ç¨‹: platform/wtf/ThreadProgrammingInBlink. md</li><li>Workers: <a href="https://chromium.googlesource.com/chromium/src/+/master/third_party/blink/renderer/core/workers/README.md" target="_blank" rel="noopener noreferrer">core/workers/README. md</a></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="blink-çš„åˆå§‹åŒ–å’Œç»ˆæ­¢"></a><code>Blink</code> çš„åˆå§‹åŒ–å’Œç»ˆæ­¢<a aria-hidden="true" tabindex="-1" class="hash-link" href="#blink-çš„åˆå§‹åŒ–å’Œç»ˆæ­¢" title="Direct link to heading">#</a></h3><p><code>Blink</code> é€šè¿‡<a href="https://cs.chromium.org/chromium/src/third_party/blink/renderer/controller/blink_initializer.cc?sq=package:chromium&amp;dr=C&amp;g=0&amp;l=86" target="_blank" rel="noopener noreferrer"> <code>BlinkInitializer::Initialize()</code> </a>æ¥åˆå§‹åŒ–ã€‚è¿™ä¸ªæ–¹æ³•å¿…é¡»åœ¨æ‰§è¡Œ <code>Blink</code> ä»£ç å‰è°ƒç”¨ã€‚</p><p><code>Blink</code> æ²¡æœ‰ç»ˆæ­¢åŒ–çš„çŠ¶æ€ï¼ŒåŸå› æ˜¯æ¸²æŸ“è¿›ç¨‹æ˜¯è¢«å¼ºåˆ¶é€€å‡ºçš„ï¼Œè€Œä¸æ˜¯è¢«æ¸…ç†å›æ”¶çš„ã€‚åŸå› ä¹‹ä¸€æ˜¯å‡ºäºæ€§èƒ½çš„è€ƒè™‘ï¼ˆå¼ºåˆ¶é€€å‡ºä¸éœ€è¦åšé¢å¤–çš„æ“ä½œï¼‰ã€‚å¦ä¸€ä¸ªåŸå› æ˜¯æ¸²æŸ“è¿›ç¨‹åœ¨æ­£å¸¸é€€å‡ºçš„æƒ…å†µä¸‹ï¼Œä¸€èˆ¬å¾ˆéš¾æŠŠæ‰€ä»¥ä¸œè¥¿éƒ½æ¸…ç†å›æ”¶æ‰ã€‚ï¼ˆå¹¶ä¸”è¿™æ ·åšçš„ä»£ä»·é«˜äºå¸¦æ¥çš„æ•ˆç›Šï¼‰</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="ç›®å½•æ¶æ„"></a>ç›®å½•æ¶æ„<a aria-hidden="true" tabindex="-1" class="hash-link" href="#ç›®å½•æ¶æ„" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="content-public-apis-å’Œ-blink-public-apis"></a><code>Content public APIs</code> å’Œ <code>Blink public APIs</code><a aria-hidden="true" tabindex="-1" class="hash-link" href="#content-public-apis-å’Œ-blink-public-apis" title="Direct link to heading">#</a></h3><p><a href="https://cs.chromium.org/chromium/src/content/public/" target="_blank" rel="noopener noreferrer"> <code>Content public APIs</code> </a>æ˜¯ç”¨åµŒå…¥æ¸²æŸ“å¼•æ“çš„APIå±‚ã€‚ <code>Content public APIs</code> å¿…é¡»å°å¿ƒç»´æŠ¤ï¼Œå› ä¸ºå®ƒä»¬æ˜¯æä¾›ç»™ï¼ˆæƒ³å†…åµŒ <code>Blink</code> å¼•æ“çš„ï¼‰åµŒå…¥å™¨çš„ã€‚</p><p><a href="https://cs.chromium.org/chromium/src/third_party/blink/public/?q=blink/public&amp;sq=package:chromium&amp;dr" target="_blank" rel="noopener noreferrer"> <code>Blink public APIs</code> </a>æ˜¯ä¸º <code>Chromium</code> æä¾› <code>//third_party/blink/</code> ä¸­çš„ <code>Blink</code> åŠŸèƒ½çš„APIå±‚ã€‚ <code>Blink public APIs</code> ç»§æ‰¿è‡ª <code>Webkit APIs</code> ã€‚åœ¨ <code>Webkit</code> æ—¶ä»£ï¼Œç”±äº <code>Chromium</code> å’Œ <code>Safari</code> ä¼šå…±äº« <code>Webkit</code> çš„å®ç°ï¼Œæ‰€ä»¥å½“æ—¶è¿™ä¸ªAPIå±‚æ—¢è¦é¡¾åŠ <code>Chromium</code> ä¹Ÿè¦é¡¾åŠ <code>Safari</code> ã€‚è€Œç°åœ¨ <code>Blink</code> å†…æ ¸çš„åŠŸèƒ½åªéœ€è¦æä¾›ç»™ <code>Chromium</code> ï¼Œæ—§çš„APIå±‚æœ‰äº›APIå°±ä¸éœ€è¦äº†ã€‚æ‰€ä»¥æˆ‘ä»¬å°† <code>Chromium</code> ä¸­ä¸å¹³å°ç›¸å…³çš„ä»£ç è¿ç§»åˆ° <code>Blink</code> ä¸­æ¥å‡å°‘ <code>Blink public APIs</code> çš„æ•°é‡ï¼ˆè¿™ä¸ªé¡¹ç›®è¢«å«ä½œ <code>Onion Soup</code> ï¼‰</p><p><img alt="img" src="/assets/images/image1-5f960c71119af2fb9789f5364132eef3.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="ç›®å½•æ¶æ„å’Œä¾èµ–"></a>ç›®å½•æ¶æ„å’Œä¾èµ–<a aria-hidden="true" tabindex="-1" class="hash-link" href="#ç›®å½•æ¶æ„å’Œä¾èµ–" title="Direct link to heading">#</a></h3><p><code>//third_party/blink/</code> çš„ç›®å½•å¦‚ä¸‹ï¼ŒæŸ¥é˜…<a href="https://chromium.googlesource.com/chromium/src/+/master/third_party/blink/renderer/README.md" target="_blank" rel="noopener noreferrer">è¿™ä¸ªæ–‡æ¡£</a>äº†è§£æ›´å¤šã€‚</p><ul><li>platform/<ul><li>ä¸€ç»„ä»core/é‡Œé¢åˆ†è§£å‡ºæ¥çš„ <code>Blink</code> åº•å±‚åŠŸèƒ½ï¼Œæ¯”å¦‚åœ°ç†ä½ç½® <code>geometry</code> å’Œå›¾å½¢ <code>graphics</code> ç›¸å…³çš„åº“</li></ul></li><li>core/ å’Œ modules/<ul><li>å®ç°Webå¹³å°è§„æ ¼æ–‡ä»¶çš„æ‰€æœ‰åŠŸèƒ½ã€‚core/ä¸»è¦æ˜¯å®ç° <code>DOM</code> ç›¸å…³çš„åŠŸèƒ½ã€‚modules/ä¸»è¦å®ç°äº†ä¸€äº›æµè§ˆå™¨è‡ªæœ‰çš„åŠŸèƒ½ï¼Œæ¯”å¦‚ <code>webaudio</code> , <code>indexeddb</code> ã€‚</li></ul></li><li>bindings/core/ å’Œ bindings/modules/<ul><li>ä»å‘½åå°±å¯ä»¥çŒœåˆ°ï¼Œ <code>bindings/core/</code> æ˜¯ <code>core/</code> çš„ä¸€éƒ¨åˆ†ï¼Œ <code>bindings/modules/</code> æ˜¯ <code>modules/</code> çš„ä¸€éƒ¨åˆ†ã€‚é¢‘ç¹è°ƒç”¨ <code>V8 APIs</code> çš„æ–‡ä»¶éƒ½æ”¾åœ¨ <code>bindings/{core,modules}</code> é‡Œé¢</li></ul></li><li>controller/<ul><li>ä¸€äº›è°ƒç”¨ <code>core/</code> å’Œ <code>modules/</code> çš„é¡¶å±‚å·¥å…·åº“ï¼ˆæ¯”å¦‚devtoolsçš„å‰ç«¯éƒ¨åˆ† <code>devtools front-end</code> ï¼‰</li></ul></li></ul><p>å„éƒ¨åˆ†ä»£ç çš„ä¾èµ–å…³ç³»å¦‚ä¸‹ï¼š</p><ul><li><code>Chromium</code> =&gt; <code>controller/</code> =&gt; <code>modules/</code> å’Œ <code>bindings/modules/</code> =&gt; <code>core/</code> å’Œ <code>bindings/core/</code> =&gt; <code>platform/</code> =&gt; åº•å±‚åŸè¯­ æ¯”å¦‚ <code>//base</code> , <code>//v8</code> å’Œ <code>//cc</code>
æä¾›ç»™ <code>//third_party/blink/</code> åº•å±‚åŸè¯­åœ¨ <code>Blink</code> é¡¹ç›®ä¸­è¢«å°å¿ƒç¿¼ç¿¼åœ°ç²¾å¿ƒç»´æŠ¤ç€</li></ul><p>äº†è§£æ›´å¤šï¼š</p><ul><li>ç›®å½•æ¶æ„å’Œä¾èµ–ï¼š<a href="https://chromium.googlesource.com/chromium/src/+/master/third_party/blink/renderer/README.md" target="_blank" rel="noopener noreferrer">blink/renderer/README. md</a></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="wtf"></a>WTF<a aria-hidden="true" tabindex="-1" class="hash-link" href="#wtf" title="Direct link to heading">#</a></h3><p><code>WTF</code> æ˜¯ <code>Blink</code> ç‰¹æœ‰çš„å·¥å…·åº“ï¼Œä½äº <code>platform/wtf/</code> ã€‚æˆ‘ä»¬å°½å¯èƒ½ç»Ÿä¸€ <code>Chromium</code> å’Œ <code>Blink</code> çš„ä»£ç ï¼Œæ‰€ä»¥ <code>WTF</code> çš„ä½“ç§¯ä¼šå¾ˆå°ã€‚ <code>WTF</code> è¿™ä¸ªå·¥å…·åº“ä¹‹æ‰€ä»¥å­˜åœ¨ï¼Œæ˜¯å› ä¸ºå¯¹äº <code>Blink</code> çš„å·¥ä½œè´Ÿè½½å’Œ <code>Oilpan</code> (å³ <code>Blink GC</code> ) ä¸­æœ‰å¤§é‡çš„ç±»å‹ï¼ˆ <code>types</code> ï¼‰ï¼Œå®¹å™¨ï¼ˆ <code>containers</code> ï¼‰å’Œå®ï¼ˆ <code>macros</code> ï¼‰éœ€è¦åšæ€§èƒ½ä¼˜åŒ–ã€‚å¦‚æœç±»å‹åœ¨ <code>WTF</code> ä¸­æœ‰ç›¸åº”çš„å®šä¹‰ï¼Œåœ¨ <code>Blink</code> ä¸­å°±éœ€è¦ä½¿ç”¨ <code>WTF</code> çš„ç±»å‹è€Œä¸æ˜¯å®šä¹‰åœ¨ <code>//base</code> æˆ–è€… <code>std libraries</code> ä¸­çš„ç±»å‹ã€‚
ä½¿ç”¨çš„æœ€å¤šçš„ç±»å‹æ˜¯ <code>vectors</code> , <code>hashsets</code> , <code>hashmaps</code> å’Œ <code>strings</code> ã€‚ç›¸åº”çš„åœ¨ <code>Blink</code> ä¸­åº”è¯¥ä½¿ç”¨ <code>WTF::Vector</code> , <code>WTF::HashSet</code> , <code>WTF::HashMap</code> , <code>WTF::String</code> å’Œ <code>WTF::AtomicString</code> è€Œä¸æ˜¯ <code>std::vector</code> , <code>std::*set,</code>  <code>std::*map</code> å’Œ <code>std::string</code> ã€‚</p><p>äº†è§£æ›´å¤š:</p><ul><li>å¦‚ä½•ä½¿ç”¨ <code>WTF</code> : <a href="https://chromium.googlesource.com/chromium/src/+/master/third_party/blink/renderer/platform/wtf/README.md" target="_blank" rel="noopener noreferrer">platform/wtf/README. md</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="å†…å­˜ç®¡ç†"></a>å†…å­˜ç®¡ç†<a aria-hidden="true" tabindex="-1" class="hash-link" href="#å†…å­˜ç®¡ç†" title="Direct link to heading">#</a></h2><p>ä½ éœ€è¦å…³æ³¨ä¸‰ä¸ªä¸ <code>Blink</code> ç›¸å…³çš„å†…å­˜åˆ†é…å™¨ã€‚</p><ul><li><a href="https://chromium.googlesource.com/chromium/src/+/master/base/allocator/partition_allocator/PartitionAlloc.md" target="_blank" rel="noopener noreferrer">PartitionAlloc</a></li><li><a href="https://chromium.googlesource.com/chromium/src/+/master/third_party/blink/renderer/platform/heap/BlinkGCAPIReference.md" target="_blank" rel="noopener noreferrer">Oilpan</a> (å³Blink GC)</li><li>malloc/free or new/delete (ç¦æ­¢ä½¿ç”¨c++åŸç”Ÿçš„)</li></ul><p>ç»™ä¸€ä¸ªå¯¹è±¡åˆ†é… <code>PartitionAlloc</code> ä¸Šçš„å †å†…å­˜ï¼Œå¯ä»¥ç”¨ <code>USING_FAST_MALLOC()</code></p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">class SomeObject {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  USING_FAST_MALLOC(SomeObject);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  static std::unique_ptr&lt;SomeObject&gt; Create() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return std::make_unique&lt;SomeObject&gt;();  // Allocated on PartitionAlloc&#x27;s heap.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">};</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>ä¸€ä¸ªç”± <code>PartitionAlloc</code> åˆ†é…çš„å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸåº”è¯¥è¢« <code>scoped_refptr&lt;&gt;</code> å’Œ <code>std::unique_ptr&lt;&gt;</code> ç®¡ç†ã€‚å¼ºçƒˆä¸å»ºè®®æ‰‹åŠ¨å»ç®¡ç†ç”Ÿå‘½å‘¨æœŸã€‚æ‰‹åŠ¨å›æ”¶å†…å­˜åœ¨ <code>Blink</code> æ˜¯ä¸å…è®¸çš„ã€‚</p><p>ç»™ä¸€ä¸ªå¯¹è±¡åˆ†é… <code>Oilpan</code> ä¸Šçš„å †å†…å­˜ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>GarbageCollected</code> ã€‚</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">class SomeObject : public GarbageCollected&lt;SomeObject&gt; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  static SomeObject* Create() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return new SomeObject;  // Allocated on Oilpan&#x27;s heap.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">};</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p><code>Oilpan</code> å †å†…å­˜ä¸­çš„å¯¹è±¡ç”Ÿå‘½å‘¨æœŸæ˜¯ç”± <code>garbage collection</code> è‡ªåŠ¨ç®¡ç†çš„ã€‚ä½ éœ€è¦ä½¿ç”¨ç‰¹æ®Šçš„æŒ‡é’ˆï¼ˆæ¯”å¦‚ <code>Member&lt;&gt;</code> ï¼Œ <code>Persistent&lt;&gt;</code> ï¼‰æ¥å­˜ <code>Oilpan</code> å †å†…å­˜ä¸­çš„å¯¹è±¡ã€‚å‚è€ƒè¿™ä¸ªAPIæ‰‹å†Œ<a href="https://chromium.googlesource.com/chromium/src/+/master/third_party/blink/renderer/platform/heap/BlinkGCAPIReference.md" target="_blank" rel="noopener noreferrer">this API reference</a>æ¥ç†Ÿæ‚‰åœ¨ <code>Oilpan</code> ä¸Šå¼€å‘çš„ä¸€äº›é™åˆ¶ã€‚æœ€é‡è¦çš„ä¸€ä¸ªé™åˆ¶å°±æ˜¯åœ¨ä¸€ä¸ª <code>Oilpan</code> å¯¹è±¡çš„è§£æ„å‡½æ•°ä¸­ä¸å…è®¸å¤„ç†ä»»ä½•å…¶ä»–çš„ <code>Oilpan</code> å¯¹è±¡ã€‚ï¼ˆåŸå› æ˜¯è§£æ„çš„é¡ºåºæ˜¯æ²¡æœ‰ä¿è¯çš„ï¼‰</p><p>å¦‚æœä½ æ—¢æ²¡æœ‰ä½¿ç”¨ <code>USING_FAST_MALLOC()</code> ä¹Ÿæ²¡æœ‰ä½¿ç”¨ <code>GarbageCollected</code> ï¼Œé‚£ä¹ˆå¯¹è±¡å°±è¢«åˆ†é…åœ¨ç³»ç»Ÿå †å†…å­˜ä¸­ã€‚è¿™åœ¨ <code>Blink</code> ä¸­æ˜¯æå…¶ä¸æ¨èçš„ã€‚æ‰€æœ‰çš„ <code>Blink</code> å¯¹è±¡éƒ½åº”è¯¥æŒ‰å¦‚ä¸‹è§„åˆ™åˆ†é…åœ¨ <code>PartitionAlloc</code> æˆ–è€… <code>Oilpan</code> çš„å †å†…å­˜ä¸­ã€‚</p><ul><li>é»˜è®¤ä½¿ç”¨ <code>Oilpan</code></li><li>ä»…åœ¨ä¸‰ç§æƒ…å†µä¸‹ä½¿ç”¨ <code>PartitionAlloc</code><ul><li>å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸéå¸¸æ¸…æ™°ï¼Œåªç”¨ <code>std::unique_ptr&lt;&gt;</code> å’Œ <code>scoped_refptr&lt;&gt;</code> å°±å¯ä»¥æ»¡è¶³éœ€æ±‚</li><li>å½“ä½¿ç”¨ <code>Oilpan</code> åˆ†é…å†…å­˜ç»™å½“å‰æƒ…å†µå¢åŠ å¾ˆå¤šçš„å¤æ‚æ€§æ—¶</li><li>å½“ä½¿ç”¨ <code>Oilpan</code> åˆ†é…å†…å­˜ç»™å½“å‰æƒ…å†µçš„åƒåœ¾å›æ”¶æœºåˆ¶ <code>garbage collection runtime</code> å¸¦æ¥äº†å¤§é‡ä¸å¿…è¦çš„ï¼ˆæ€§èƒ½ï¼‰å‹åŠ›æ—¶</li></ul></li></ul><p>ä¸ç®¡ä½¿ç”¨ <code>PartitionAlloc</code> è¿˜æ˜¯ <code>Oilpan</code> æ¥åˆ†é…å†…å­˜ï¼Œéƒ½éœ€è¦æå…¶å°å¿ƒï¼Œä»¥å…åˆ›å»ºå‡ºæ‚¬ç©ºæŒ‡é’ˆ( <code>Dangling pointer</code> )ç”šè‡³å†…å­˜æ³„éœ²(Note: è£¸æŒ‡é’ˆä¹Ÿæ˜¯æå…¶å…¶ä¸æ¨èçš„)</p><p>äº†è§£æ›´å¤šï¼š</p><ul><li>å¦‚ä½•ä½¿ç”¨ <code>PartitionAlloc</code> : <a href="https://chromium.googlesource.com/chromium/src/+/master/third_party/blink/renderer/platform/wtf/allocator/Allocator.md" target="_blank" rel="noopener noreferrer">platform/wtf/allocator/Allocator. md</a></li><li>å¦‚ä½•ä½¿ç”¨ <code>Oilpan</code> : <a href="https://chromium.googlesource.com/chromium/src/+/master/third_party/blink/renderer/platform/heap/BlinkGCAPIReference.md" target="_blank" rel="noopener noreferrer">platform/heap/BlinkGCAPIReference. md</a></li><li>Oilpan GC è®¾è®¡: <a href="https://chromium.googlesource.com/chromium/src/+/master/third_party/blink/renderer/platform/heap/BlinkGCDesign.md" target="_blank" rel="noopener noreferrer">platform/heap/BlinkGCDesign. md</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="ä»»åŠ¡è°ƒåº¦"></a>ä»»åŠ¡è°ƒåº¦<a aria-hidden="true" tabindex="-1" class="hash-link" href="#ä»»åŠ¡è°ƒåº¦" title="Direct link to heading">#</a></h2><p>ä¸ºäº†æå‡æ¸²æŸ“å¼•æ“çš„å“åº”é€Ÿåº¦ï¼Œåœ¨ <code>Blink</code> ä¸­çš„ä»»åŠ¡éƒ½åº”è¯¥å°½å¯èƒ½çš„å¼‚æ­¥æ‰§è¡Œã€‚åŒæ­¥çš„ <code>IPC/Mojo</code> æˆ–è€…å…¶ä»–å¯èƒ½è€—è´¹æ•°æ¯«ç§’çš„æ“ä½œéƒ½æ˜¯ä¸æ¨èä½¿ç”¨çš„ã€‚ï¼ˆå°½ç®¡æœ‰äº›æ“ä½œæ— æ³•é¿å…ï¼Œæ¯”å¦‚æ‰§è¡Œç”¨æˆ·çš„ <code>JavaScript</code> ï¼Œå…¶ <code>JavaScript</code> ä»£ç æœ¬èº«å¯èƒ½ä¼šé˜»å¡æ¸²æŸ“ï¼‰ã€‚</p><p>åœ¨æ¸²æŸ“è¿›ç¨‹ä¸­çš„æ‰€æœ‰ä»»åŠ¡éƒ½ä¼šé€šçŸ¥<a href="https://chromium.googlesource.com/chromium/src/+/lkcr/third_party/WebKit/Source/platform/scheduler/README.md" target="_blank" rel="noopener noreferrer"> <code>Blink Scheduler</code> </a>ï¼Œä¸”æä¾›è‡ªå·±ç›¸åº”çš„ä»»åŠ¡ç±»å‹ï¼Œå¦‚ä¸‹é¢è¿™æ ·ï¼š</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">// Post a task to frame&#x27;s scheduler with a task type of kNetworking</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">frame-&gt;GetTaskRunner(TaskType::kNetworking)-&gt;PostTask(..., WTF::Bind(&amp;Function));</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p><code>Blink Scheduler</code> ç»´æŠ¤ç€å¤šä¸ªä»»åŠ¡é˜Ÿåˆ—ï¼Œå¹¶æ ¹æ®ä»»åŠ¡çš„ä¼˜å…ˆçº§è‡ªåŠ¨è¿›è¡Œæ’åºæ¥æå‡æ€§èƒ½ï¼Œæœ€å¤§åŒ–æå‡ç”¨æˆ·ä½“éªŒã€‚æä¾›<a href="https://cs.chromium.org/chromium/src/third_party/blink/public/platform/task_type.h?q=blink+tasktype&amp;sq=package:chromium&amp;dr=CSs&amp;l=5" target="_blank" rel="noopener noreferrer">æ­£ç¡®çš„ä»»åŠ¡ç±»å‹</a>å¯¹äº <code>Blink Schedule</code> çš„é«˜æ•ˆè°ƒåº¦æ˜¯ååˆ†é‡è¦çš„ã€‚</p><p>äº†è§£æ›´å¤šï¼š</p><ul><li>How to post tasks å¦‚ä½•å‘èµ·ä»»åŠ¡: platform/scheduler/PostTask. md</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="page--frame--document--domwindow-etc"></a><code>Page</code> , <code>Frame</code> , <code>Document</code> , <code>DOMWindow</code> etc<a aria-hidden="true" tabindex="-1" class="hash-link" href="#page--frame--document--domwindow-etc" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="æ¦‚å¿µ"></a>æ¦‚å¿µ<a aria-hidden="true" tabindex="-1" class="hash-link" href="#æ¦‚å¿µ" title="Direct link to heading">#</a></h3><p><code>Page</code> , <code>Frame</code> , <code>Document</code> , <code>ExecutionContext</code> å’Œ <code>DOMWindow</code> çš„å«ä¹‰å¦‚ä¸‹ï¼š</p><ul><li><code>Page</code> å¯¹åº”tabé¡µï¼ˆå¦‚æœä¸‹æ–‡ä»‹ç»çš„ <code>OOPIF</code> æ²¡æœ‰å¼€å¯çš„è¯ï¼‰ã€‚ä¸€ä¸ªæ¸²æŸ“è¿›ç¨‹å¯èƒ½ä¼šæ¸²æŸ“å¤šä¸ªtabé¡µ</li><li><code>Frame</code> å¯¹åº” <code>frame</code> ( <code>main frame</code> æˆ–è€…ä¸€ä¸ª <code>iframe</code> )ã€‚ä¸€ä¸ª <code>Page</code> åŒ…å«ä¸€ä¸ªæˆ–è€…å¤šä¸ª <code>Frame</code> å¹¶ä¸”åŒ…å«åœ¨ä¸€ä¸ªæ ‘ç»“æ„ä¸­ã€‚</li><li><code>DOMWindow</code> å¯¹åº” <code>Javascript</code> ä¸­çš„ <code>window</code> å¯¹è±¡ã€‚æ¯ä¸ª <code>Frame</code> æœ‰ä¸€ä¸ª <code>DOMWindow</code> ã€‚</li><li><code>Document</code> å¯¹åº” <code>Javascript</code> ä¸­çš„ <code>window.document</code> å¯¹è±¡ã€‚æ¯ä¸ª <code>Frame</code> æœ‰ä¸€ä¸ª <code>Document</code> ã€‚</li><li><code>ExecutionContext</code> æ˜¯ï¼ˆä¸»çº¿ç¨‹çš„ï¼‰ <code>Document</code> å’Œï¼ˆå·¥ä½œçº¿ç¨‹çš„ï¼‰ <code>WorkerGlobalScope</code> çš„æŠ½è±¡ã€‚</li></ul><p>æ¸²æŸ“è¿›ç¨‹ ï¼š <code>Page</code> = 1 : N.
<code>Page</code> : <code>Frame</code> = 1 : M.
<code>Frame</code> : <code>DOMWindow</code> : <code>Document</code> (or <code>ExecutionContext</code> ) = 1 : 1 : 1ï¼ˆåœ¨ä»»ä½•æ—¶åˆ»éƒ½æˆç«‹ï¼Œä¸è¿‡æ˜ å°„å…³ç³»å¯èƒ½ä¼šæ”¹å˜ï¼‰</p><p>ä¸¾ä¸ªæ —å­ï¼š</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">iframe.contentWindow.location.href = &quot;https://example.com&quot;;</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè®¿é—® <code>https://example.com.</code> åˆ›å»ºäº†æ–°çš„ <code>DOMWindow</code> å’Œ <code>Document</code> ï¼Œè€Œ <code>Frame</code> åˆ™å¯èƒ½è¢«é‡ç”¨ã€‚ï¼ˆNote: å‡†ç¡®çš„æ¥è¯´ï¼Œè¿˜å­˜åœ¨ä¸€äº›<a href="https://docs.google.com/presentation/d/1pHjF3TNCX--j0ss3SK09pXlVOFK0Cdq6HkMcOzcov1o/edit#slide=id.g4983c55b2d55fcc7_42" target="_blank" rel="noopener noreferrer">æ›´å¤æ‚çš„æƒ…å†µ</a>åˆ›å»ºäº†æ–°çš„ <code>Document</code> ï¼Œè€Œ <code>DOMWindow</code> å’Œ <code>Frame</code> è¢«é‡ç”¨äº†ï¼‰ã€‚</p><p>äº†è§£æ›´å¤šï¼š</p><ul><li>core/frame/FrameLifecycle. md</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="out-of-process-iframes-oopif-è¿›ç¨‹å¤–çš„iframe"></a>Out-of-Process iframes (OOPIF è¿›ç¨‹å¤–çš„iframe)<a aria-hidden="true" tabindex="-1" class="hash-link" href="#out-of-process-iframes-oopif-è¿›ç¨‹å¤–çš„iframe" title="Direct link to heading">#</a></h3><p><a href="https://www.chromium.org/developers/design-documents/site-isolation" target="_blank" rel="noopener noreferrer">Site Isolation</a> ç½‘ç«™éš”ç¦»å¢åŠ äº†å®‰å…¨æ€§çš„åŒæ—¶ä¹Ÿå¢åŠ äº†å¤æ‚æ€§ã€‚:) <code>Site Isolation</code> çš„è®¾æƒ³æ˜¯ä¸ºæ¯ä¸€ä¸ªç½‘ç«™åˆ›å»ºä¸€ä¸ªæ¸²æŸ“è¿›ç¨‹ ã€‚</p><p>(A site is a pageâ€™s registrable domain + 1 label, and its URL scheme. For example, <a href="https://mail.example.com" target="_blank" rel="noopener noreferrer">https://mail.example.com</a> and <a href="https://chat.example.com" target="_blank" rel="noopener noreferrer">https://chat.example.com</a> are in the same site, but <a href="https://noodles.com" target="_blank" rel="noopener noreferrer">https://noodles.com</a> and <a href="https://pumpkins.com" target="_blank" rel="noopener noreferrer">https://pumpkins.com</a> are not. )</p><p>å¦‚æœ <code>Page</code> åŒ…å«è·¨ç«™çš„ <code>iframe</code> , é‚£ä¹ˆè¿™ä¸ª <code>Page</code> å¯èƒ½è¢«ä¸¤ä¸ªæ¸²æŸ“è¿›ç¨‹å…±åŒæ¸²æŸ“ã€‚å‚è€ƒä¸‹é¢è¿™ç§ <code>Page</code> :</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;!-- https://example.com --&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;body&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;iframe src=&quot;https://example2.com&quot;&gt;&lt;/iframe&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;/body&gt;</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>ä¸» <code>frame</code> å’Œ <code>iframe</code> å¯èƒ½è¿è¡Œåœ¨ä¸åŒçš„æ¸²æŸ“è¿›ç¨‹ä¸­ã€‚æ¸²æŸ“è¿›ç¨‹æœ¬åœ°çš„ <code>frame</code> ç”± <code>LocalFrame</code> å‘ˆç°ï¼Œä¸å±äºæ¸²æŸ“è¿›ç¨‹æœ¬åœ°çš„ <code>frame</code> ç”± <code>RemoteFrame</code> å‘ˆç°ã€‚</p><p>ä»ä¸» <code>frame</code> çš„è§’åº¦æ¥çœ‹ï¼Œä¸» <code>frame</code> æ˜¯ä¸€ä¸ª <code>LocalFrame</code> è€Œ <code>iframe</code> æ˜¯ä¸€ä¸ª <code>RemoteFrame</code> ã€‚ä» <code>iframe</code> çš„è§’åº¦æ¥çœ‹ï¼Œä¸» <code>frame</code> æ˜¯ä¸€ä¸ª <code>RemoteFrame</code> ï¼Œè€Œ <code>iframe</code> æ˜¯ä¸€ä¸ª <code>LocalFrame</code> ã€‚</p><p><code>LocalFrame</code> å’Œ <code>RemoteFrame</code> ï¼ˆä¸¤è€…å¯èƒ½å­˜åœ¨ä¸ä¸åŒçš„æ¸²æŸ“è¿›ç¨‹ä¸­ï¼‰ä¹‹é—´çš„é€šä¿¡æ˜¯æµè§ˆå™¨è¿›ç¨‹æ¥å¤„ç†çš„ã€‚</p><p>äº†è§£æ›´å¤šï¼š</p><ul><li><p>Design docs è®¾è®¡æ–‡æ¡£ï¼š <a href="https://www.chromium.org/developers/design-documents/site-isolation" target="_blank" rel="noopener noreferrer">Site isolation design docs</a></p></li><li><p>How to write code with site isolationï¼š core/frame/SiteIsolation. md</p></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="detached-frame--document--åˆ†ç¦»çš„frame--document"></a>Detached Frame / Document  åˆ†ç¦»çš„Frame / Document<a aria-hidden="true" tabindex="-1" class="hash-link" href="#detached-frame--document--åˆ†ç¦»çš„frame--document" title="Direct link to heading">#</a></h3><p><code>Frame</code> / <code>Document</code> å¯èƒ½å¤„äºåˆ†ç¦»çš„çŠ¶æ€ã€‚å‚è€ƒä¸‹é¢çš„æ —å­ï¼š</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">doc = iframe.contentDocument;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">iframe.remove();  // The iframe is detached from the DOM tree.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">doc.createElement(&quot;div&quot;);  // But you still can run scripts on the detached frame.</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>ä¸€ä¸ªå¾ˆéªšçš„äº‹å®æ˜¯ï¼Œåœ¨åˆ†ç¦»çš„ <code>frame</code> ä¸­ä½ ä»èƒ½å¤Ÿè¿è¡Œè„šæœ¬å’Œæ‰§è¡ŒDOMæ“ä½œã€‚ç”±äº <code>frame</code> å·²ç»è¢«åˆ†ç¦»ï¼Œå¤§éƒ¨åˆ†DOMæ“ä½œä¼šå¤±è´¥å¹¶æŠ¥é”™ã€‚å¯æƒœåˆ†ç¦»çš„ <code> frame</code> çš„è¡¨ç°åœ¨ä¸åŒæµè§ˆå™¨ä¸­å¹¶ä¸ä¸€è‡´ï¼Œåœ¨è§„æ ¼æ–‡ä»¶ä¸­ä¹Ÿæ²¡æœ‰éå¸¸æ˜ç¡®çš„å®šä¹‰ã€‚å¤§ä½“ä¸Šæ¥è¯´ï¼ŒæœŸæœ›çš„è¡¨ç°æ˜¯åœ¨ <code>frame</code> åˆ†ç¦»å <code>JavaScript</code> è¿˜æ˜¯å¯ä»¥æ­£å¸¸çš„æ‰§è¡Œï¼Œä½†æ˜¯å¤§å¤šæ•°DOMæ“ä½œéƒ½åº”è¯¥å¤±è´¥å¹¶æŠ›å‡ºå¼‚å¸¸ï¼Œå¦‚ï¼š</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">void someDOMOperation(...) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  if (!script_state_-&gt;ContextIsValid()) { // The frame is already detached</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    â€¦;  // Set an exception etc</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>è¿™æ„å‘³ç€ <code>Blink</code> éœ€è¦åœ¨ <code>frame</code> è¢«åˆ†ç¦»æ—¶åšå¤§é‡çš„æ¸…é™¤å›æ”¶æ“ä½œã€‚è¿™äº›æ“ä½œå¯ä»¥é€šè¿‡<a href="https://cs.chromium.org/chromium/src/third_party/blink/renderer/core/dom/context_lifecycle_observer.h?type=cs&amp;q=contextlifecycleobserver&amp;sq=package:chromium&amp;g=0&amp;l=95" target="_blank" rel="noopener noreferrer"> <code>ContextLifecycleObserver</code> </a>ç»§æ‰¿è€Œæ¥ï¼Œå¦‚ï¼š</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">class SomeObject : public GarbageCollected&lt;SomeObject&gt;, public ContextLifecycleObserver {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  void ContextDestroyed() override {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // Do clean-up operations here.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ~SomeObject() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // It&#x27;s not a good idea to do clean-up operations here because it&#x27;s too late to do them. Also a destructor is not allowed to touch any other objects on Oilpan&#x27;s heap.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">};</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="web-idl-bindings-web-idlç»‘å®š"></a>Web IDL bindings: Web IDLç»‘å®š<a aria-hidden="true" tabindex="-1" class="hash-link" href="#web-idl-bindings-web-idlç»‘å®š" title="Direct link to heading">#</a></h2><p>å½“ <code>JavaScript</code> è®¿é—® <code>node.firstChild</code> çš„æ—¶å€™ï¼Œ <code>node.h</code> ä¸­çš„ <code>Node::firstChild()</code> å³è¢«è°ƒç”¨ã€‚å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„å‘¢ï¼Œä¸€èµ·æ¥çœ‹çœ‹ <code>node.firstChild</code> æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼š</p><p>é¦–å…ˆï¼Œä½ éœ€è¦ä¸ºæ¯ä¸€ä¸ªè§„æ ¼å®šä¹‰ä¸€ä¸ªIDLæ–‡ä»¶ï¼Œå¦‚ï¼š</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">// node.idl</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">interface Node : EventTarget {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  [...] readonly attribute Node? firstChild;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">};</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>Web IDLçš„è¯­æ³•å®šä¹‰åœ¨ <a href="https://heycam.github.io/webidl/" target="_blank" rel="noopener noreferrer">the Web IDL spec</a> ä¸­ã€‚ <code>[...]</code> è¢«ç§°ä¸º <code>IDL extended attributes</code> ã€‚
<code>the Web IDL spec</code> é‡Œé¢å®šä¹‰äº†ä¸€äº› <code>IDL extended attributes</code> ï¼Œå…¶ä»–çš„åœ¨<a href="https://chromium.googlesource.com/chromium/src/+/master/third_party/blink/renderer/bindings/IDLExtendedAttributes.md" target="_blank" rel="noopener noreferrer"> Blink-specific IDL extended attributes</a>ä¸­ã€‚é™¤äº† <code>Blink</code> ç‰¹æœ‰çš„ <code>IDL extended attributes</code> ï¼Œå…¶ä»–IDLæ–‡ä»¶éƒ½åº”è¯¥æŒ‰ç…§å’Œè§„æ ¼æ–‡ä»¶ä¸€è‡´çš„æ ¼å¼æ¥å†™ï¼ˆæ„æ€å°±æ˜¯ç›´æ¥ä»è§„æ ¼æ–‡ä»¶é‡Œé¢cvï¼‰ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œä½ éœ€è¦ä¸º <code>Node</code> èŠ‚ç‚¹å®šä¹‰ä¸€ä¸ª <code>C++ class</code> ç±»ï¼Œå¹¶ç”¨c++å®ç° <code>firstChild</code> çš„ <code>getter</code> ï¼Œå¦‚ï¼š</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">class EventTarget : public ScriptWrappable {  // All classes exposed to JavaScript must inherit from ScriptWrappable.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ...;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">};</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class Node : public EventTarget {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  DEFINE_WRAPPERTYPEINFO();  // All classes that have IDL files must have this macro.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  Node* firstChild() const { return first_child_; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">};</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™æ ·å°±å¯ä»¥äº†ã€‚å½“ä½ æ„å»º <code>node.idl</code> ï¼Œ<a href="https://chromium.googlesource.com/chromium/src/+/master/third_party/blink/renderer/bindings/IDLCompiler.md" target="_blank" rel="noopener noreferrer"> <code>the IDL compiler</code> </a>ä¼šä¸º <code>Node interface</code> å’Œ <code>Node.firstChild</code> è‡ªåŠ¨ç”Ÿæˆ <code>Blink</code> - <code>V8</code> çš„ç»‘å®šã€‚è¿™ä¸ªè‡ªåŠ¨ç”Ÿæˆç»‘å®šçš„æ“ä½œä½äº<a href="https://cs.chromium.org/chromium/src/out/Debug/gen/third_party/blink/renderer/bindings/core/v8/v8_node.h?q=v8node&amp;sq=package:chromium&amp;dr=CSs&amp;l=11" target="_blank" rel="noopener noreferrer"> <code>//src/out/{Debug,Release}/gen/third_party/ blink/renderer/bindings/core/v8/v8_node.h</code> </a>ä¸­ã€‚å½“ <code>JavaScript</code> è°ƒç”¨ <code>node.firstChild</code> æ—¶ï¼Œ <code>V8</code> å°±ä» <code>v8_node.h</code> å»è°ƒç”¨ <code> V8Node::firstChildAttributeGetterCallback()</code> ï¼Œæ¥ç€å°±ä¼šè°ƒç”¨ä½ ä¸Šé¢å®šä¹‰çš„ <code>Node::firstChild()</code> ã€‚</p><p>äº†è§£æ›´å¤šï¼š</p><ul><li>How to add Web IDL bindings: bindings/IDLCompiler. md</li><li>How to use IDL extended attributes: bindings/- IDLExtendedAttributes. md</li><li>Spec: Web IDL spec</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="v8-å’Œ-blink"></a>V8 å’Œ Blink<a aria-hidden="true" tabindex="-1" class="hash-link" href="#v8-å’Œ-blink" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="isolate-context-world"></a>Isolate, Context, World<a aria-hidden="true" tabindex="-1" class="hash-link" href="#isolate-context-world" title="Direct link to heading">#</a></h3><p>å½“ä½ å†™å’Œ <code>V8 APIs</code> æœ‰å…³çš„ä»£ç æ—¶ï¼Œç†è§£ <code>Isolate, Context, World</code> è¿™ä¸‰ä¸ªæ¦‚å¿µå¾ˆé‡è¦ã€‚å®ƒä»¬åœ¨ä»£ç åº“ä¸­åˆ†åˆ«æ˜¯ <code>v8::Isolate</code> , <code>v8::Context</code> å’Œ <code>DOMWrapperWorld</code> ã€‚</p><p><code>Isolate</code> æ˜¯ä¸€ä¸ªç‰©ç†ä¸Šçš„çº¿ç¨‹ï¼Œåœ¨ <code>Blink</code> ä¸­ <code>Isolate : physical=1ï¼š1</code> ã€‚ä¸»çº¿ç¨‹å’Œå·¥ä½œçº¿ç¨‹éƒ½æœ‰å…¶ç‹¬ç«‹çš„ <code>Isolate</code> ã€‚</p><p><code>Context</code> æ˜¯ä¸€ä¸ªå…¨å±€çš„å¯¹è±¡ï¼ˆä»¥ <code>Frame</code> æ¥è¯´ï¼Œ <code>Frame</code> çš„ <code>Context</code> æ˜¯ <code>window</code> å¯¹è±¡ï¼‰ã€‚ç”±äºæ¯ä¸ª <code>frame</code> æœ‰è‡ªå·±çš„ <code>window</code> å¯¹è±¡ï¼Œæ‰€ä»¥ä¸€ä¸ªæ¸²æŸ“è¿›ç¨‹ä¸­ä¼šæœ‰å¤šä¸ª <code>Context</code> ã€‚å½“è°ƒç”¨ <code>V8 APIs</code> æ—¶ï¼Œä½ éœ€è¦ç¡®è®¤ä½ åœ¨æ­£ç¡®çš„ <code>Context</code> ä¸­ã€‚å¦åˆ™ï¼Œ <code>v8::Isolate::GetCurrentContext()</code> å°±ä¼šè¿”å›ä¸€ä¸ªä¸æ­£ç¡®çš„ <code>Context</code> ï¼Œæœ€åçš„æƒ…å†µä¼šé€ æˆå¯¹è±¡æ³„éœ²å¹¶å¯¼è‡´å®‰å…¨é—®é¢˜ã€‚</p><p><code>World</code> æ”¯æ’‘ <code>Chrome extensions</code> è„šæœ¬çš„è¿è¡Œã€‚ <code>Worlds</code> å’Œä»»ä½•webæ ‡å‡†éƒ½æ²¡æœ‰å…³ç³»ã€‚ <code>Chrome extensions</code> è„šæœ¬å’Œé¡µé¢å…±äº«DOMï¼Œä¸è¿‡å¤„äºå®‰å…¨çš„è€ƒè™‘ï¼Œ <code>Chrome extensions</code> è„šæœ¬çš„ <code>JavaScript</code> å’Œé¡µé¢çš„ <code>JavaScript</code> å †å†…å­˜æ˜¯ç›¸äº’éš”ç¦»çš„ã€‚ï¼ˆå¹¶ä¸” <code>Chrome extensions</code> è„šæœ¬ä¹‹é—´çš„ <code>JavaScript</code> å †å†…å­˜ä¹Ÿæ˜¯ç›¸äº’éš”ç¦»çš„ï¼‰ã€‚ä¸»çº¿ç¨‹é€šè¿‡ä¸ºé¡µé¢åˆ›å»ºä¸€ä¸ª <code>main world</code> å’Œä¸ºæ¯ä¸ª <code>Chrome extensions</code> è„šæœ¬åˆ›å»ºä¸€ä¸ª <code>isolated world</code> æ¥å®ç°éš”ç¦»ã€‚ <code>main world</code> å’Œ <code>isolated worlds</code> éƒ½å¯ä»¥è®¿é—®åˆ°C++ä¸Šçš„DOMå¯¹è±¡ï¼Œä½†æ˜¯ä»–ä»¬å„è‡ªçš„ <code>JavaScript</code> å¯¹è±¡éƒ½æ˜¯éš”ç¦»çš„ã€‚è¿™ç§éš”ç¦»æ˜¯é€šè¿‡ä¸ºæ¯ä¸ª <code>C++DOM</code> å¯¹è±¡åˆ›å»ºå¤šä¸ª <code>V8 wrapper</code> æ¥å®ç°çš„ã€‚å³æ¯ä¸ª <code>world</code> å¯¹åº”ä¸€ä¸ª <code>V8 wrapper</code> ã€‚</p><p><img src="/assets/images/image4-a56d5f098ac5ddaf0e9c7018812bc4ce.png"></p><p><code>Context</code> , <code>World</code> å’Œ <code>Frame</code> ä¹‹é—´æœ‰ä»€ä¹ˆè”ç³»ï¼Ÿ
æƒ³è±¡ä¸€ä¸‹ï¼Œ åœ¨ä¸»çº¿ç¨‹ä¸­å­˜åœ¨Nä¸ª <code>World</code> ï¼ˆä¸€ä¸ª <code>main world </code> +ï¼ˆN-1ï¼‰ä¸ª <code>isolated worlds)</code> ï¼‰ã€‚é‚£ä¹ˆä¸€ä¸ª <code>Frame</code> å°±æœ‰Nä¸ª <code>window objects</code> ï¼Œæ¯ä¸ª <code>window objects</code> å¯¹åº”ä¸€ä¸ª <code>world</code> ã€‚è€Œ <code>Context</code> ä¹Ÿæ˜¯å¯¹åº” <code>window objects</code> ï¼Œè¿™æ„å‘³ç€å½“å­˜åœ¨Nä¸ª <code>Frame</code> å’ŒNä¸ª <code>Worlds</code> çš„æ—¶å€™ï¼Œæœ‰M*Nä¸ª <code>Contexts</code> ï¼ˆä¸è¿‡ <code>Contexts</code> æ˜¯æ‡’åŠ è½½åˆ›å»ºçš„ï¼‰</p><p>å¯¹äº <code>worker</code> è€Œè¨€ï¼Œåªæœ‰ä¸€ä¸ª <code>World</code> å’Œä¸€ä¸ª <code>global object</code> ï¼Œæ‰€ä»¥å°±åªå­˜åœ¨ä¸€ä¸ª <code>Context</code>
æ­¤å¤–ï¼Œå½“ä½ ä½¿ç”¨ <code>V8 APIs</code> çš„æ—¶å€™ï¼Œä½ åº”è¯¥éå¸¸æ³¨æ„æ˜¯å¦ä½¿ç”¨äº†æ­£ç¡®çš„ <code>context</code> ï¼Œå¦åˆ™ä½ å¯èƒ½å¯¼è‡´åœ¨ä¸åŒçš„ <code>isolated worlds</code> é—´æ³„éœ² <code>JavaScript</code> å¯¹è±¡ç”šè‡³å¯¼è‡´ç¾éš¾èˆ¬çš„å®‰å…¨é—®é¢˜ã€‚ï¼ˆæ¯”å¦‚ï¼Œä½¿å¾—A. comçš„ <code>Chrome extetion</code> å¯ä»¥æ“çºµB. comçš„ <code>Chrome extetion</code> ï¼‰</p><p>äº†è§£æ›´å¤š:</p><ul><li><a href="https://chromium.googlesource.com/chromium/src/+/master/third_party/blink/renderer/bindings/core/v8/V8BindingDesign.md" target="_blank" rel="noopener noreferrer">bindings/core/v8/V8BindingDesign. md</a></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="v8-apis"></a>V8 APIs<a aria-hidden="true" tabindex="-1" class="hash-link" href="#v8-apis" title="Direct link to heading">#</a></h3><p><a href="https://cs.chromium.org/chromium/src/v8/include/v8.h?q=v8.h&amp;sq=package:chromium&amp;dr=CSs&amp;l=10" target="_blank" rel="noopener noreferrer">//v8/include/v8. h. </a>é‡Œé¢æœ‰å¤§é‡çš„V8 APIsã€‚ç”±äº <code>V8 APIs</code> éƒ½æ¯”è¾ƒåº•å±‚ï¼Œä½¿ç”¨èµ·æ¥ç•¥æ˜¾éº»çƒ¦ï¼Œæ‰€ä»¥ä¸€èˆ¬ä½¿ç”¨<a href="https://cs.chromium.org/chromium/src/third_party/blink/renderer/platform/bindings/?q=platform/bindings&amp;sq=package:chromium&amp;dr" target="_blank" rel="noopener noreferrer">platform/bindings/ </a> æä¾›çš„ä¸€ç»„å°è£…äº†çš„ <code>V8 APIs</code> è¾…åŠ©ç±»æ¥ï¼ˆ <code>helper classes</code> ï¼‰è¿›è¡Œè°ƒç”¨ã€‚ä½ åº”è¯¥å°½é‡ä½¿ç”¨ <code>helper classes</code> ã€‚å¦‚æœä½ çš„ä»£ç ä¸­ä¼šé‡åº¦ä½¿ç”¨åŸç”Ÿ <code>V8 APIs</code> ï¼Œè¿™äº›ä»£ç åº”è¯¥æ”¾åˆ° <code>bindings/{core,modules}</code> é‡Œé¢å»ã€‚</p><p>V8ä½¿ç”¨ <code>handle</code> æ¥æŒ‡å‘ <code>V8 objects</code> ã€‚æœ€å¸¸è§çš„ <code>handle</code> æ˜¯ <code>v8::Local&lt;&gt;</code> , <code>v8::Local&lt;&gt;</code> ç”¨äºä»æœºå™¨å †æ ˆ <code>machine stack</code> æŒ‡å‘ <code>V8 objects</code> ã€‚ <code>v8::Local&lt;&gt;</code> å¿…é¡»åœ¨ <code>v8::HandleScope</code> ä»æœºå™¨å †æ ˆ <code>machine stack</code> åˆ†é…ä¹‹åæ‰èƒ½ä½¿ç”¨ã€‚ <code>v8::Local&lt;&gt;</code> ä¹Ÿä¸èƒ½åœ¨ <code>machine stack</code> ä¹‹å¤–ä½¿ç”¨ï¼š</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">void function() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  v8::HandleScope scope;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  v8::Local&lt;v8::Object&gt; object = ...;  // This is correct.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class SomeObject : public GarbageCollected&lt;SomeObject&gt; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  v8::Local&lt;v8::Object&gt; object_;  // This is wrong.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">};</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>è¦ä»æœºå™¨å †æ ˆ <code>machine stack</code> æŒ‡å¤–æŒ‡å‘ <code>V8 objects</code> ï¼Œä½ éœ€è¦ä½¿ç”¨ <a href="https://chromium.googlesource.com/chromium/src/+/master/third_party/blink/renderer/platform/bindings/TraceWrapperReference.md" target="_blank" rel="noopener noreferrer">wrapper tracing</a>ã€‚ç„¶è€Œä½ éœ€è¦ç‰¹åˆ«å°å¿ƒåœ°ä½¿ç”¨ï¼Œä»¥å…åˆ›å»ºå‡ºå¾ªç¯å¼•ç”¨ã€‚é€šå¸¸ <code>V8 APIs</code> éƒ½æ˜¯éš¾ç”¨çš„ã€‚å¦‚æœä½ ä¸ç¡®å®šä½ çš„ç”¨æ³•å¯ä»¥ä¸Š<a href="https://groups.google.com/a/chromium.org/forum/#!forum/blink-reviews-bindings" target="_blank" rel="noopener noreferrer">blink-review-bindings@</a>æé—®ã€‚</p><p>äº†è§£æ›´å¤šï¼š</p><ul><li>How to use V8 APIs and helper classes: platform/bindings/HowToUseV8FromBlink. md</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="v8-wrappers"></a>V8 wrappers<a aria-hidden="true" tabindex="-1" class="hash-link" href="#v8-wrappers" title="Direct link to heading">#</a></h3><p>æ¯ä¸ª <code>C++ DOM</code> å¯¹è±¡ï¼ˆæ¯”å¦‚ï¼ŒNodeèŠ‚ç‚¹ï¼‰éƒ½æœ‰å…¶å¯¹åº”çš„ <code>V8 wrapper</code> ã€‚å‡†ç¡®çš„è¯´ï¼Œæ¯ä¸ª <code>world</code> çš„æ¯ä¸ª <code>C++ DOM</code> å¯¹è±¡éƒ½æœ‰å…¶å¯¹åº”çš„ <code>V8 wrapper</code> ã€‚</p><p><code>V8 wrappers</code> å¯¹å®ƒç›¸åº”çš„ <code>C++ DOM</code> æ˜¯å¼ºå¼•ç”¨å…³ç³»ã€‚è€Œ <code>C++ DOM</code> å¯¹ <code>V8 wrappers</code> åˆ™æ˜¯å¼±å¼•ç”¨å…³ç³»ã€‚æ‰€ä»¥å¦‚æœæƒ³è¦ä½¿ <code>V8 wrappers</code> åœ¨ä¸€æ®µç‰¹å®šçš„å‘¨æœŸå»¶ç»­ï¼Œä½ éœ€è¦æ˜ç¡®åœ°æŒ‡å®šã€‚å¦åˆ™ <code>V8 wrappers</code> å¯èƒ½ä¼šè¢«æå‰å›æ”¶ï¼Œå¯¼è‡´ <code>V8 wrappers</code> ä¸Šçš„ <code>JS properties</code> ä¸¢å¤±... </p><div class="mdxCodeBlock_1XEh"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">div = document.getElementbyId(&quot;div&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">child = div.firstChild;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">child.foo = &quot;bar&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">child = null;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">gc();  // If we don&#x27;t do anything, the V8 wrapper of |firstChild| is collected by the GC.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">assert(div.firstChild.foo === &quot;bar&quot;);  //...and this will fail.</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></div><p>å¦‚æœä»€ä¹ˆéƒ½ä¸åšçš„è¯ï¼Œ <code>child</code> å°±ä¼šè¢« <code>GC</code> å›æ”¶ï¼Œå³ <code>child.foo</code> å°±ä¸å­˜åœ¨äº†ã€‚è¦ä¿ç•™ <code>div.firstChild</code> ä¸Šçš„ <code>V8 wrapper</code> çš„è¯ï¼Œæˆ‘ä»¬éœ€è¦å¢åŠ ä¸€ä¸ªæœºåˆ¶æ¥å®ç°ï¼šåªè¦ <code>div</code> æ‰€å±çš„ <code>DOM tree</code> è¿˜å¯ä»¥é€šè¿‡ <code>V8</code> è®¿é—®åˆ°ï¼Œå°±ä¸€ç›´ä¿ç•™ <code>div.firstChild</code> ä¸Šçš„ <code>V8 wrapper</code> ã€‚</p><p>æœ‰ä¸¤ç§æ–¹å¼æ¥ä¿ç•™ <code>V8 wrappers</code> ï¼š<a href="https://cs.chromium.org/chromium/src/third_party/blink/renderer/bindings/core/v8/active_script_wrappable.h?q=activescriptwrappable&amp;sq=package:chromium&amp;dr=CSs&amp;l=16" target="_blank" rel="noopener noreferrer">ActiveScriptWrappable</a>å’Œ<a href="https://chromium.googlesource.com/chromium/src/+/master/third_party/blink/renderer/platform/bindings/TraceWrapperReference.md" target="_blank" rel="noopener noreferrer">wrapper tracing. </a></p><p>äº†è§£æ›´å¤šï¼š</p><ul><li>How to manage lifetime of V8 wrappers: bindings/core/v8/V8Wrapper. md</li><li>How to use wrapper tracing: <a href="https://chromium.googlesource.com/chromium/src/+/master/third_party/blink/renderer/platform/bindings/TraceWrapperReference.md" target="_blank" rel="noopener noreferrer">platform/bindings/TraceWrapperReference. md</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="æ¸²æŸ“ç®¡é“-rendering-pipeline"></a>æ¸²æŸ“ç®¡é“ Rendering pipeline<a aria-hidden="true" tabindex="-1" class="hash-link" href="#æ¸²æŸ“ç®¡é“-rendering-pipeline" title="Direct link to heading">#</a></h2><p>ä¸€ä¸ªHTMLæ–‡ä»¶ä»ä¼ é€’åˆ° <code>Blink</code> å†åˆ°å±å¹•ä¸Šæ˜¾ç¤ºçš„åƒç´ ä¹‹é—´æœ‰ä¸€æ®µå¾ˆé•¿çš„å†ç¨‹ã€‚æ¸²æŸ“ç®¡é“çš„æ¶æ„å¦‚ä¸‹ï¼š</p><p><img src="/assets/images/image6-1f96cbec997357b0210e5f9f30cc79e2.png"></p><p><a href="https://docs.google.com/presentation/d/1boPxbgNrTU0ddsc144rcXayGA_WF53k96imRH8Mp34Y/edit#slide=id.p" target="_blank" rel="noopener noreferrer">Life of A Pixel</a>é‡Œé¢ä»‹ç»äº†æ¸²æŸ“ç®¡é“çš„æ¯ä¸€ä¸ªé˜¶æ®µã€‚</p><p>äº†è§£æ›´å¤šï¼š</p><ul><li>overview: <a href="https://docs.google.com/presentation/d/1boPxbgNrTU0ddsc144rcXayGA_WF53k96imRH8Mp34Y/edit#slide=id.g60f92a5151_40_1415" target="_blank" rel="noopener noreferrer">Life of a Pixel</a></li><li>DOM: <a href="https://chromium.googlesource.com/chromium/src/+/master/third_party/blink/renderer/core/dom/README.md" target="_blank" rel="noopener noreferrer">core/dom/README. md</a></li><li>Style: <a href="https://chromium.googlesource.com/chromium/src/+/master/third_party/blink/renderer/core/css/README.md" target="_blank" rel="noopener noreferrer">core/css/README. md</a></li><li>Layout: <a href="https://chromium.googlesource.com/chromium/src/+/master/third_party/blink/renderer/core/layout/README.md" target="_blank" rel="noopener noreferrer">core/layout/README. md</a></li><li>Paintï¼š <a href="https://chromium.googlesource.com/chromium/src/+/master/third_party/blink/renderer/core/paint/README.md" target="_blank" rel="noopener noreferrer">core/paint/README. md</a></li><li>Compositor thread: <a href="https://www.chromium.org/developers/design-documents/chromium-graphics" target="_blank" rel="noopener noreferrer">Chromium graphics</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="questions"></a>Questions?<a aria-hidden="true" tabindex="-1" class="hash-link" href="#questions" title="Direct link to heading">#</a></h2><p>æœ‰é—®é¢˜å¯ä»¥åˆ° <a href="https://groups.google.com/a/chromium.org/forum/#!forum/blink-dev" target="_blank" rel="noopener noreferrer">blink-dev@chromium.org</a> å’Œ <a href="https://groups.google.com/a/chromium.org/forum/#!forum/platform-architecture-dev" target="_blank" rel="noopener noreferrer">platform-architecture-dev@chromium</a> æé—®ã€‚</p></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« TCP3æ¬¡æ¡æ‰‹å’Œ4æ¬¡æŒ¥æ‰‹</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/FE/React/ReactHooksä½¿ç”¨å¿ƒå¾—/doc-ReactHooksä½¿ç”¨å¿ƒå¾—"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">ReactHooksä½¿ç”¨å¿ƒå¾— Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#blink-åšäº†ä»€ä¹ˆ" class="table-of-contents__link"><code>Blink</code> åšäº†ä»€ä¹ˆ</a></li><li><a href="#è¿›ç¨‹çº¿ç¨‹-æ¶æ„" class="table-of-contents__link">è¿›ç¨‹/çº¿ç¨‹ æ¶æ„</a><ul><li><a href="#è¿›ç¨‹" class="table-of-contents__link">è¿›ç¨‹</a></li><li><a href="#çº¿ç¨‹" class="table-of-contents__link">çº¿ç¨‹</a></li><li><a href="#blink-çš„åˆå§‹åŒ–å’Œç»ˆæ­¢" class="table-of-contents__link"><code>Blink</code> çš„åˆå§‹åŒ–å’Œç»ˆæ­¢</a></li></ul></li><li><a href="#ç›®å½•æ¶æ„" class="table-of-contents__link">ç›®å½•æ¶æ„</a><ul><li><a href="#content-public-apis-å’Œ-blink-public-apis" class="table-of-contents__link"><code>Content public APIs</code> å’Œ <code>Blink public APIs</code></a></li><li><a href="#ç›®å½•æ¶æ„å’Œä¾èµ–" class="table-of-contents__link">ç›®å½•æ¶æ„å’Œä¾èµ–</a></li><li><a href="#wtf" class="table-of-contents__link">WTF</a></li></ul></li><li><a href="#å†…å­˜ç®¡ç†" class="table-of-contents__link">å†…å­˜ç®¡ç†</a></li><li><a href="#ä»»åŠ¡è°ƒåº¦" class="table-of-contents__link">ä»»åŠ¡è°ƒåº¦</a></li><li><a href="#page--frame--document--domwindow-etc" class="table-of-contents__link"><code>Page</code> , <code>Frame</code> , <code>Document</code> , <code>DOMWindow</code> etc</a><ul><li><a href="#æ¦‚å¿µ" class="table-of-contents__link">æ¦‚å¿µ</a></li><li><a href="#out-of-process-iframes-oopif-è¿›ç¨‹å¤–çš„iframe" class="table-of-contents__link">Out-of-Process iframes (OOPIF è¿›ç¨‹å¤–çš„iframe)</a></li><li><a href="#detached-frame--document--åˆ†ç¦»çš„frame--document" class="table-of-contents__link">Detached Frame / Document  åˆ†ç¦»çš„Frame / Document</a></li></ul></li><li><a href="#web-idl-bindings-web-idlç»‘å®š" class="table-of-contents__link">Web IDL bindings: Web IDLç»‘å®š</a></li><li><a href="#v8-å’Œ-blink" class="table-of-contents__link">V8 å’Œ Blink</a><ul><li><a href="#isolate-context-world" class="table-of-contents__link">Isolate, Context, World</a></li><li><a href="#v8-apis" class="table-of-contents__link">V8 APIs</a></li><li><a href="#v8-wrappers" class="table-of-contents__link">V8 wrappers</a></li></ul></li><li><a href="#æ¸²æŸ“ç®¡é“-rendering-pipeline" class="table-of-contents__link">æ¸²æŸ“ç®¡é“ Rendering pipeline</a></li><li><a href="#questions" class="table-of-contents__link">Questions?</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="text--center"><div>Copyright Â© 2020 LeoY233. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.da09b0aa.js"></script>
<script src="/runtime~main.872dded8.js"></script>
<script src="/main.2f1d5848.js"></script>
<script src="/1.f45b894e.js"></script>
<script src="/2.a477ba05.js"></script>
<script src="/3.b78202e8.js"></script>
<script src="/1be78505.89b8407a.js"></script>
<script src="/171.d3ef19ea.js"></script>
<script src="/935f2afb.43a6fc9a.js"></script>
<script src="/17896441.30e2172e.js"></script>
<script src="/38ab2617.b77077ba.js"></script>
</body>
</html>